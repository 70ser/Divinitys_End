execute unless score @s TRIDENT_USED matches 1.. run particle minecraft:end_rod ~ ~ ~ 0 0 0 0.02 1 force
execute unless score @s TRIDENT_USED matches 1.. run effect give @s slow_falling 1 0 true

# While the player is using riptide, replace the trident with a duplicate that does a ton of extra damage (replace once/tick so it can't be used midair)
execute if score @s TRIDENT_HAND matches 1.. run clear @s minecraft:trident{timetrident:1b}
execute if score @s TRIDENT_HAND matches 1 run item replace entity @s weapon.mainhand with trident{display:{Name:'{"text":"Trident of Time (Riptide)","color":"gold","bold":true,"italic":false}',Lore:['{"text":"Riptide III","color":"gray","italic":false}','{"text":" "}','{"text":"Bend the very fabric of time","color":"dark_gray","italic":false}','{"text":"to reach your destination","color":"dark_gray","italic":false}','{"text":" "}','{"text":"Temporal Storm","color":"gray","italic":false,"underlined":true}','{"text":"Riptide deals 5x damage","color":"dark_gray","italic":false}','{"text":" "}','{"text":"When in Main Hand:","color":"gray","italic":false}','{"text":" 6 Attack Damage","color":"dark_green","italic":false}','{"text":" 1.1 Attack Speed","color":"dark_green","italic":false}']},HideFlags:7,Unbreakable:1b,timetrident:1b,riptide:1b,Enchantments:[{id:"minecraft:riptide",lvl:3s}],AttributeModifiers:[{AttributeName:"generic.attack_damage",Name:"generic.attack_damage",Amount:30,Operation:0,UUID:[I;-729428737,751062592,-1765663393,843334149]},{AttributeName:"generic.attack_speed",Name:"generic.attack_speed",Amount:1.1,Operation:0,UUID:[I;-200267019,1238912642,-1366305132,-1806722825]}]}
execute if score @s TRIDENT_HAND matches 2 run item replace entity @s weapon.offhand with trident{display:{Name:'{"text":"Trident of Time (Riptide)","color":"gold","bold":true,"italic":false}',Lore:['{"text":"Riptide III","color":"gray","italic":false}','{"text":" "}','{"text":"Bend the very fabric of time","color":"dark_gray","italic":false}','{"text":"to reach your destination","color":"dark_gray","italic":false}','{"text":" "}','{"text":"Temporal Storm","color":"gray","italic":false,"underlined":true}','{"text":"Riptide deals 5x damage","color":"dark_gray","italic":false}','{"text":" "}','{"text":"When in Main Hand:","color":"gray","italic":false}','{"text":" 6 Attack Damage","color":"dark_green","italic":false}','{"text":" 1.1 Attack Speed","color":"dark_green","italic":false}']},HideFlags:7,Unbreakable:1b,timetrident:1b,riptide:1b,Enchantments:[{id:"minecraft:riptide",lvl:3s}],AttributeModifiers:[{AttributeName:"generic.attack_damage",Name:"generic.attack_damage",Amount:30,Operation:0,UUID:[I;-729428737,751062592,-1765663393,843334149]},{AttributeName:"generic.attack_speed",Name:"generic.attack_speed",Amount:1.1,Operation:0,UUID:[I;-200267019,1238912642,-1366305132,-1806722825]}]}

# Play a sound effect & particle burst when the player collides with an enemy during riptide
execute if score @s TRIDENT_HIT matches 150.. run function t:timetrident/collide

# When the trident comes off cooldown and the player is grounded, reset the trident to its original state
execute if score @s TRIDENT_COOLDOWN matches 0 if data storage suso:dep {curr:{OnGround:1b}} run function t:timetrident/end

stopsound @s * minecraft:item.armor.equip_generic